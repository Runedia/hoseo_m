# Shuttle API Documentation

í˜¸ì„œëŒ€í•™êµ ì…”í‹€ë²„ìŠ¤ ì‹œê°„í‘œ ê´€ë ¨ REST API ë¬¸ì„œìž…ë‹ˆë‹¤.

## Base URL
```
/shuttle
```

## ê°œìš”

í˜¸ì„œëŒ€í•™êµ ìº í¼ìŠ¤ ê°„ ì…”í‹€ë²„ìŠ¤ ì‹œê°„í‘œ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” APIìž…ë‹ˆë‹¤.
- ìš”ì¼ë³„ ì‹œê°„í‘œ ì§€ì› (í‰ì¼, í† ìš”ì¼, ì¼ìš”ì¼/ê³µíœ´ì¼)
- ë©”ëª¨ë¦¬ ìºì‹±ìœ¼ë¡œ ë¹ ë¥¸ ì‘ë‹µ ì†ë„
- ì‹¤ì‹œê°„ ì‹œê°„í‘œ ì¡°íšŒ ê¸°ëŠ¥

## ì§€ì› ë…¸ì„ 

| Route Code | ì¶œë°œì§€ | ë„ì°©ì§€ | ì„¤ëª… |
|------------|--------|--------|------|
| `1` | ì•„ì‚°ìº í¼ìŠ¤ | ì²œì•ˆìº í¼ìŠ¤ | ì•„ì‚° â†’ ì²œì•ˆ ì…”í‹€ë²„ìŠ¤ |
| `2` | ì²œì•ˆìº í¼ìŠ¤ | ì•„ì‚°ìº í¼ìŠ¤ | ì²œì•ˆ â†’ ì•„ì‚° ì…”í‹€ë²„ìŠ¤ |

## ìš”ì¼ ë¶„ë¥˜

| Day Type | ìš”ì¼ | ì„¤ëª… |
|----------|------|------|
| `weekday` | ì›”~ê¸ˆ | í‰ì¼ ì‹œê°„í‘œ |
| `saturday` | í†  | í† ìš”ì¼ ì‹œê°„í‘œ |
| `sunday` | ì¼ | ì¼ìš”ì¼/ê³µíœ´ì¼ ì‹œê°„í‘œ |

---

## API Endpoints

### 1. ì…”í‹€ë²„ìŠ¤ ì‹œê°„í‘œ ì¡°íšŒ

íŠ¹ì • ë‚ ì§œì™€ ë…¸ì„ ì˜ ì…”í‹€ë²„ìŠ¤ ì‹œê°„í‘œë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

**Endpoint:** `GET /shuttle/schedule`

#### Request Parameters (Query String)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `date` | string | âœ… | ì¡°íšŒ ë‚ ì§œ (YYYY-MM-DD í˜•ì‹) |
| `route` | string | âœ… | ë…¸ì„  ë²ˆí˜¸ (1: ì•„ì‚°â†’ì²œì•ˆ, 2: ì²œì•ˆâ†’ì•„ì‚°) |

#### Example Request
```bash
GET /shuttle/schedule?date=2025-01-20&route=1
```

#### Success Response (200)
```json
{
  "success": true,
  "data": {
    "date": "2025-01-20",
    "dayType": "weekday",
    "route": "1",
    "schedule": {
      "error": {
        "pos1": "",
        "pos7": ""
      },
      "bus_001": {
        "pos1": "07:30",
        "pos7": "08:15"
      },
      "bus_002": {
        "pos1": "08:30",
        "pos7": "09:15"
      },
      "bus_003": {
        "pos1": "09:30",
        "pos7": "10:15"
      },
      "bus_004": {
        "pos1": "10:30",
        "pos7": "11:15"
      }
    }
  },
  "message": "ì‹œê°„í‘œ ì¡°íšŒ ì„±ê³µ"
}
```

#### ë°ì´í„° êµ¬ì¡° ì„¤ëª…

- **pos1**: ì¶œë°œì§€ ì‹œê°„
- **pos7**: ë„ì°©ì§€ ì‹œê°„
- **bus_XXX**: ê° ë²„ìŠ¤ ìš´í–‰ ë²ˆí˜¸
- **error**: ì‹œìŠ¤í…œ ì—ëŸ¬ë‚˜ ìš´í–‰ ì¤‘ë‹¨ ì •ë³´ (ì¼ë°˜ì ìœ¼ë¡œ ë¹ˆ ê°’)

#### Error Response (400)
```json
{
  "success": false,
  "message": "ë‚ ì§œ(date)ì™€ ë…¸ì„  ë²ˆí˜¸(route)ê°€ í•„ìš”í•©ë‹ˆë‹¤."
}
```

#### Error Response (400 - ìž˜ëª»ëœ ë‚ ì§œ í˜•ì‹)
```json
{
  "success": false,
  "message": "ë‚ ì§œëŠ” YYYY-MM-DD í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤."
}
```

#### Error Response (400 - ìž˜ëª»ëœ ë…¸ì„ )
```json
{
  "success": false,
  "message": "í˜„ìž¬ ë…¸ì„  1ë²ˆ, 2ë²ˆë§Œ ì§€ì›ë©ë‹ˆë‹¤."
}
```

---

### 2. ì…”í‹€ë²„ìŠ¤ ìƒì„¸ ì‹œê°„í‘œ ì¡°íšŒ

íŠ¹ì • ë²„ìŠ¤ ìš´í–‰ì˜ ìƒì„¸ ì‹œê°„í‘œë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. (í˜„ìž¬ êµ¬í˜„ ì¤‘)

**Endpoint:** `GET /shuttle/schedule/detail`

#### Request Parameters (Query String)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `date` | string | âœ… | ì¡°íšŒ ë‚ ì§œ (YYYY-MM-DD í˜•ì‹) |
| `route` | string | âœ… | ë…¸ì„  ë²ˆí˜¸ (1: ì•„ì‚°â†’ì²œì•ˆ, 2: ì²œì•ˆâ†’ì•„ì‚°) |
| `schedule` | string | âœ… | ë²„ìŠ¤ ìš´í–‰ ë²ˆí˜¸ (ì˜ˆ: bus_001) |

#### Example Request
```bash
GET /shuttle/schedule/detail?date=2025-01-20&route=1&schedule=bus_001
```

#### Success Response (200)
```json
{
  "success": true,
  "data": {
    "date": "2025-01-20",
    "dayType": "weekday",
    "route": "1",
    "scheduleNumber": "bus_001",
    "detail": {
      "pos1": "07:30",
      "pos2": "07:35",
      "pos3": "07:40",
      "pos4": "07:50",
      "pos5": "08:00",
      "pos6": "08:10",
      "pos7": "08:15"
    }
  },
  "message": "ì‹œê°„í‘œ ìƒì„¸ ì¡°íšŒ ì„±ê³µ"
}
```

#### Error Response (404)
```json
{
  "success": false,
  "message": "ìŠ¤ì¼€ì¤„ ë²ˆí˜¸ bus_999ì„(ë¥¼) ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
}
```

---

### 3. ìºì‹œ ìƒíƒœ í™•ì¸ (ë””ë²„ê¹…ìš©)

ì‹œìŠ¤í…œì˜ ì‹œê°„í‘œ ìºì‹œ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

**Endpoint:** `GET /shuttle/cache/status`

#### Example Request
```bash
GET /shuttle/cache/status
```

#### Success Response (200)
```json
{
  "success": true,
  "data": {
    "1_weekday": {
      "loaded": true,
      "scheduleCount": 15,
      "isDefault": false
    },
    "1_saturday": {
      "loaded": true,
      "scheduleCount": 8,
      "isDefault": false
    },
    "1_sunday": {
      "loaded": true,
      "scheduleCount": 5,
      "isDefault": false
    },
    "2_weekday": {
      "loaded": true,
      "scheduleCount": 15,
      "isDefault": false
    },
    "2_saturday": {
      "loaded": true,
      "scheduleCount": 8,
      "isDefault": false
    },
    "2_sunday": {
      "loaded": true,
      "scheduleCount": 5,
      "isDefault": false
    }
  },
  "message": "ìºì‹œ ìƒíƒœ ì¡°íšŒ ì„±ê³µ"
}
```

#### ìºì‹œ ìƒíƒœ í•„ë“œ ì„¤ëª…

| Field | Type | Description |
|-------|------|-------------|
| `loaded` | boolean | ìºì‹œì— ë°ì´í„°ê°€ ë¡œë“œë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ |
| `scheduleCount` | number | ë¡œë“œëœ ì‹œê°„í‘œ ê°œìˆ˜ |
| `isDefault` | boolean | ê¸°ë³¸ê°’ ë°ì´í„°ì¸ì§€ ì—¬ë¶€ (íŒŒì¼ ë¡œë”© ì‹¤íŒ¨ ì‹œ true) |

---

## ë°ì´í„° êµ¬ì¡°

### Schedule Response êµ¬ì¡°

```json
{
  "success": boolean,
  "data": {
    "date": "YYYY-MM-DD",
    "dayType": "weekday|saturday|sunday",
    "route": "1|2",
    "schedule": {
      "bus_001": {
        "pos1": "HH:MM",
        "pos7": "HH:MM"
      }
    }
  },
  "message": string
}
```

### Detail Schedule Response êµ¬ì¡°

```json
{
  "success": boolean,
  "data": {
    "date": "YYYY-MM-DD",
    "dayType": "weekday|saturday|sunday", 
    "route": "1|2",
    "scheduleNumber": "bus_XXX",
    "detail": {
      "pos1": "HH:MM",  // ì¶œë°œì§€
      "pos2": "HH:MM",  // ì •ê±°ìž¥ 2
      "pos3": "HH:MM",  // ì •ê±°ìž¥ 3
      "pos4": "HH:MM",  // ì •ê±°ìž¥ 4
      "pos5": "HH:MM",  // ì •ê±°ìž¥ 5
      "pos6": "HH:MM",  // ì •ê±°ìž¥ 6
      "pos7": "HH:MM"   // ë„ì°©ì§€
    }
  },
  "message": string
}
```

### Error Response êµ¬ì¡°

```json
{
  "success": false,
  "message": string
}
```

---

## íŒŒì¼ ì‹œìŠ¤í…œ êµ¬ì¡°

### ì‹œê°„í‘œ ë°ì´í„° íŒŒì¼

APIëŠ” ë‹¤ìŒ JSON íŒŒì¼ë“¤ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

```
assets/
â”œâ”€â”€ ì…”í‹€(ì•„ìº _ì²œìº _ì›”ê¸ˆ).json      # ë…¸ì„ 1 í‰ì¼
â”œâ”€â”€ ì…”í‹€(ì•„ìº _ì²œìº _í† ìš”ì¼).json    # ë…¸ì„ 1 í† ìš”ì¼  
â”œâ”€â”€ ì…”í‹€(ì•„ìº _ì²œìº _ì¼ìš”ì¼_ê³µíœ´ì¼).json # ë…¸ì„ 1 ì¼ìš”ì¼/ê³µíœ´ì¼
â”œâ”€â”€ ì…”í‹€(ì²œìº _ì•„ìº _ì›”ê¸ˆ).json      # ë…¸ì„ 2 í‰ì¼
â”œâ”€â”€ ì…”í‹€(ì²œìº _ì•„ìº _í† ìš”ì¼).json    # ë…¸ì„ 2 í† ìš”ì¼
â””â”€â”€ ì…”í‹€(ì²œìº _ì•„ìº _ì¼ìš”ì¼_ê³µíœ´ì¼).json # ë…¸ì„ 2 ì¼ìš”ì¼/ê³µíœ´ì¼
```

### JSON íŒŒì¼ êµ¬ì¡° ì˜ˆì‹œ

```json
{
  "error": {
    "pos1": "",
    "pos2": "",
    "pos3": "",
    "pos4": "",
    "pos5": "",
    "pos6": "",
    "pos7": ""
  },
  "bus_001": {
    "pos1": "07:30",
    "pos2": "07:35", 
    "pos3": "07:40",
    "pos4": "07:50",
    "pos5": "08:00",
    "pos6": "08:10",
    "pos7": "08:15"
  }
}
```

---

## ìš”ì¼ íŒë³„ ë¡œì§

APIëŠ” ìž…ë ¥ëœ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ìš”ì¼ì„ íŒë³„í•©ë‹ˆë‹¤:

```javascript
// JavaScript Date ê°ì²´ ê¸°ì¤€
// ì¼ìš”ì¼=0, ì›”ìš”ì¼=1, í™”ìš”ì¼=2, ..., í† ìš”ì¼=6

if (dayOfWeek >= 1 && dayOfWeek <= 5) {
  return "weekday";  // í‰ì¼ (ì›”~ê¸ˆ)
} else if (dayOfWeek === 6) {
  return "saturday"; // í† ìš”ì¼
} else {
  return "sunday";   // ì¼ìš”ì¼
}
```

---

## ì—ëŸ¬ ì½”ë“œ

| HTTP Status | Error Type | Description |
|-------------|------------|-------------|
| 400 | Bad Request | í•„ìˆ˜ íŒŒë¼ë¯¸í„° ëˆ„ë½, ìž˜ëª»ëœ ë‚ ì§œ í˜•ì‹, ìž˜ëª»ëœ ë…¸ì„  ë²ˆí˜¸ |
| 404 | Not Found | ìš”ì²­í•œ ìŠ¤ì¼€ì¤„ ë²ˆí˜¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ |
| 500 | Internal Server Error | ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜, íŒŒì¼ ì½ê¸° ì‹¤íŒ¨ ë“± |

---

## ì‚¬ìš© ì˜ˆì‹œ

### 1. í‰ì¼ ì•„ì‚°â†’ì²œì•ˆ ì‹œê°„í‘œ ì¡°íšŒ
```bash
curl "http://localhost:3000/shuttle/schedule?date=2025-01-20&route=1"
```

### 2. í† ìš”ì¼ ì²œì•ˆâ†’ì•„ì‚° ì‹œê°„í‘œ ì¡°íšŒ  
```bash
curl "http://localhost:3000/shuttle/schedule?date=2025-01-25&route=2"
```

### 3. ì¼ìš”ì¼ ì•„ì‚°â†’ì²œì•ˆ ì‹œê°„í‘œ ì¡°íšŒ
```bash
curl "http://localhost:3000/shuttle/schedule?date=2025-01-26&route=1"
```

### 4. íŠ¹ì • ë²„ìŠ¤ ìƒì„¸ ì‹œê°„í‘œ ì¡°íšŒ
```bash
curl "http://localhost:3000/shuttle/schedule/detail?date=2025-01-20&route=1&schedule=bus_001"
```

### 5. ìºì‹œ ìƒíƒœ í™•ì¸
```bash
curl "http://localhost:3000/shuttle/cache/status"
```

---

## ì£¼ìš” ê¸°ëŠ¥

### ðŸšŒ **ì‹¤ì‹œê°„ ìš”ì¼ íŒë³„**
- ìž…ë ¥ëœ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìžë™ìœ¼ë¡œ ìš”ì¼ íƒ€ìž… ê²°ì •
- í‰ì¼, í† ìš”ì¼, ì¼ìš”ì¼/ê³µíœ´ì¼ë³„ ë‹¤ë¥¸ ì‹œê°„í‘œ ì œê³µ

### âš¡ **ë©”ëª¨ë¦¬ ìºì‹±**
- ì„œë²„ ì‹œìž‘ ì‹œ ëª¨ë“  ì‹œê°„í‘œ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ë¡œë“œ
- ë¹ ë¥¸ ì‘ë‹µ ì†ë„ ë³´ìž¥
- íŒŒì¼ I/O ìµœì†Œí™”

### ðŸ›¡ï¸ **ê²¬ê³ í•œ ì—ëŸ¬ ì²˜ë¦¬**
- íŒŒì¼ ë¡œë”© ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ê°’ ì œê³µ
- ìƒì„¸í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ
- ìž˜ëª»ëœ íŒŒë¼ë¯¸í„° ê²€ì¦

### ðŸ“ **ì •ê±°ìž¥ë³„ ì‹œê°„ ì œê³µ**
- pos1 (ì¶œë°œì§€) ~ pos7 (ë„ì°©ì§€) ê° ì •ê±°ìž¥ë³„ ì‹œê°„
- ê¸°ë³¸ ì¡°íšŒëŠ” ì¶œë°œì§€/ë„ì°©ì§€ë§Œ, ìƒì„¸ ì¡°íšŒëŠ” ì „ì²´ ì •ê±°ìž¥

---

## ì£¼ì˜ì‚¬í•­

1. **íŒŒì¼ ì˜ì¡´ì„±**: APIëŠ” `assets/` í´ë”ì˜ JSON íŒŒì¼ì— ì˜ì¡´í•©ë‹ˆë‹¤. íŒŒì¼ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’(ë¹ˆ ì‹œê°„í‘œ)ìœ¼ë¡œ ë™ìž‘í•©ë‹ˆë‹¤.

2. **ì„œë²„ ì‹œìž‘ ì‹œ ë¡œë”©**: ëª¨ë“  ì‹œê°„í‘œ ë°ì´í„°ëŠ” ì„œë²„ ì‹œìž‘ ì‹œ ë©”ëª¨ë¦¬ì— ë¡œë“œë©ë‹ˆë‹¤. íŒŒì¼ ë³€ê²½ ì‹œ ì„œë²„ ìž¬ì‹œìž‘ì´ í•„ìš”í•©ë‹ˆë‹¤.

3. **ë‚ ì§œ í˜•ì‹**: ë‚ ì§œëŠ” ë°˜ë“œì‹œ `YYYY-MM-DD` í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

4. **ë…¸ì„  ì œí•œ**: í˜„ìž¬ ë…¸ì„  1ë²ˆ(ì•„ì‚°â†’ì²œì•ˆ), 2ë²ˆ(ì²œì•ˆâ†’ì•„ì‚°)ë§Œ ì§€ì›ë©ë‹ˆë‹¤.

5. **ìƒì„¸ ì‹œê°„í‘œ**: ìƒì„¸ ì‹œê°„í‘œ APIëŠ” í˜„ìž¬ êµ¬í˜„ ì¤‘ì¸ ìƒíƒœìž…ë‹ˆë‹¤.

---

## ì„±ëŠ¥ ìµœì í™”

### **ë©”ëª¨ë¦¬ ìºì‹±**
- ëª¨ë“  ì‹œê°„í‘œ ë°ì´í„°ë¥¼ ì„œë²„ ì‹œìž‘ ì‹œ ë©”ëª¨ë¦¬ì— ë¡œë“œ
- ìš”ì²­ë‹¹ íŒŒì¼ I/O ì—†ì´ ì¦‰ì‹œ ì‘ë‹µ
- 6ê°œ íŒŒì¼(ë…¸ì„ 2ê°œ Ã— ìš”ì¼3ê°œ) ëª¨ë‘ ìºì‹±

### **íš¨ìœ¨ì ì¸ ë°ì´í„° êµ¬ì¡°**
- ë…¸ì„ ë³„, ìš”ì¼ë³„ë¡œ ë¶„ë¦¬ëœ ìºì‹œ í‚¤ ì‚¬ìš©
- í•„ìš”í•œ ë°ì´í„°ë§Œ ì¶”ì¶œí•˜ì—¬ ì‘ë‹µ í¬ê¸° ìµœì†Œí™”

---

*Last Updated: 2025-05-29*
